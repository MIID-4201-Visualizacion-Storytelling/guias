<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>guias</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" name="format-detection" content="telephone=no"><base href="/guias/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" data-hid="gf-prefetch" rel="dns-prefetch" href="https://fonts.gstatic.com/"><link data-n-head="ssr" data-hid="gf-preconnect" rel="preconnect" href="https://fonts.gstatic.com/" crossorigin=""><link data-n-head="ssr" data-hid="gf-preload" rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Material+Icons"><script data-n-head="ssr" data-hid="gf-script">!function(){var e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Material+Icons",document.querySelector("head").appendChild(e)}()</script><noscript data-n-head="ssr" data-hid="gf-noscript"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Icons"></noscript><link rel="preload" href="/guias/_nuxt/53c0541.js" as="script"><link rel="preload" href="/guias/_nuxt/ec44050.js" as="script"><link rel="preload" href="/guias/_nuxt/6b4b35f.js" as="script"><link rel="preload" href="/guias/_nuxt/f0dad64.js" as="script"><link rel="preload" href="/guias/_nuxt/f10912f.js" as="script"><style data-vue-ssr-id="6f9fdb80:0 a8238dd2:0 fa7ff0ca:0">html{box-sizing:border-box;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}body,html{margin:0;padding:0}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre,time{margin:0}h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;font-weight:700}body{min-height:100vh}button{background:0 0;border:0;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset{border:0;margin:0;padding:0}iframe{border:0}ul{list-style:none;padding:0}ul li{margin:1em}ul li:before{content:"";width:.5em;height:.5em;display:inline-block;vertical-align:middle;background-color:#2fc1d5;margin-right:.5em;border-radius:30%}img,video{max-width:100%;height:auto}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;font-weight:400}a,a:link{text-decoration:none}::-moz-selection{background-color:#f3f0ab;color:#000}::selection{background-color:#f3f0ab;color:#000}p{line-height:1.6;margin:1.5em 0}article,h1{margin:1em}h1{text-align:center;font-size:2em}h2{border-bottom:3px solid #623c97;font-size:1.6em;margin-bottom:.3em}h2,h3{padding:.5em 0}h3{border-bottom:1px dotted;font-size:1.3em;margin-bottom:.7em}h4{font-size:1.1em}.title-icon{text-align:center;display:block;font-size:2.2em}.title-icon.non-material{width:1.5em;margin:0 auto}.subtitle-icon{color:#2fc1d5;font-size:1.2em;display:inline-block;vertical-align:middle}.inline-icon{width:32px;height:auto;display:inline-block;vertical-align:bottom;margin:1em .5em 0}table{border-collapse:collapse}th{border:1px solid}td,th{padding:.5em}td{border:1px dotted}.check{display:inline-block;vertical-align:bottom;padding-right:.3em;color:green}.check.no-puede{color:red}.check.puede{color:#767a7d}#tutorial-gds{width:100%;margin:0;height:80vh}blockquote{background-color:#ddd;font-size:.8em}blockquote p{padding:1em}.iframe-container{position:relative;overflow:hidden;width:100%;padding-top:66.66%}.iframe-container iframe{position:absolute;top:0;left:0;bottom:0;right:0;width:100%;height:100%}.historia{font-size:1.2em;background-color:rgba(231,224,87,.71373);font-weight:700;padding:1em;margin:1em 3em;color:#3c6da5}#api{background-color:#353e50;color:#fff;padding:1em}#api,#api .icono{display:inline-block}#api .icono{vertical-align:middle;margin:5px;text-align:center}#api .icono p{margin:0;max-width:80px;line-height:1}#api .material-icons{font-size:2.2em;color:#d4dcec}#api .material-icons.servicio{font-size:3em;color:#cddfe7}#api .texto{border:1px solid #ecebca;padding:.5em;border-radius:5px}.proyecto{width:33%;padding:1em;border:1px dotted #0b4b80;display:inline-block;border-radius:20px;vertical-align:top;margin:1em 0}.proyecto .descripcion{font-size:.8em}code[class*=language-],pre[class*=language-]{color:#e3eaf2;background:0 0;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#3c526d}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#3c526d}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#111b27}:not(pre)>code[class*=language-]{padding:.1em .3em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8da1b9}.token.punctuation{color:#e3eaf2}.token.delimiter.important,.token.selector .parent,.token.tag,.token.tag .token.punctuation{color:#6cc}.token.attr-name,.token.boolean,.token.boolean.important,.token.constant,.token.number,.token.selector .token.attribute{color:#e6d37a}.token.class-name,.token.key,.token.parameter,.token.property,.token.property-access,.token.variable{color:#6cb8e6}.token.attr-value,.token.color,.token.inserted,.token.selector .token.value,.token.string,.token.string .token.url-link{color:#91d076}.token.builtin,.token.keyword-array,.token.package,.token.regex{color:#f4adf4}.token.function,.token.selector .token.class,.token.selector .token.id{color:#c699e3}.token.atrule .token.rule,.token.combinator,.token.keyword,.token.operator,.token.pseudo-class,.token.pseudo-element,.token.selector,.token.unit{color:#e9ae7e}.token.deleted,.token.important{color:#cd6660}.token.keyword-this,.token.this{color:#6cb8e6}.token.bold,.token.important,.token.keyword-this,.token.this{font-weight:700}.token.delimiter.important{font-weight:inherit}.token.italic{font-style:italic}.token.entity{cursor:help}.language-markdown .token.title,.language-markdown .token.title .token.punctuation{color:#6cb8e6;font-weight:700}.language-markdown .token.blockquote.punctuation{color:#f4adf4}.language-markdown .token.code{color:#6cc}.language-markdown .token.hr.punctuation{color:#6cb8e6}.language-markdown .token.url .token.content{color:#91d076}.language-markdown .token.url-link{color:#e6d37a}.language-markdown .token.list.punctuation{color:#f4adf4}.language-json .token.operator,.language-markdown .token.table-header{color:#e3eaf2}.language-scss .token.variable{color:#6cc}.token.token.cr:before,.token.token.lf:before,.token.token.space:before,.token.token.tab:not(:empty):before{color:#8da1b9}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button{color:#111b27;background:#6cb8e6}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:hover{color:#111b27;background:rgba(108,184,230,.8549);text-decoration:none}div.code-toolbar>.toolbar.toolbar>.toolbar-item>span,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:hover{color:#111b27;background:#8da1b9}.line-highlight.line-highlight{background:rgba(60,82,109,.37255);background:linear-gradient(90deg,rgba(60,82,109,.37255) 70%,rgba(60,82,109,.33333))}.line-highlight.line-highlight:before,.line-highlight.line-highlight[data-end]:after{background-color:#8da1b9;color:#111b27;box-shadow:0 1px #3c526d}pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:rgba(141,161,185,.09412)}.line-numbers.line-numbers .line-numbers-rows{border-right:1px solid #0b121b;background:rgba(11,18,27,.47843)}.line-numbers .line-numbers-rows>span:before{color:rgba(141,161,185,.8549)}.rainbow-braces .token.token.punctuation.brace-level-1,.rainbow-braces .token.token.punctuation.brace-level-5,.rainbow-braces .token.token.punctuation.brace-level-9{color:#e6d37a}.rainbow-braces .token.token.punctuation.brace-level-10,.rainbow-braces .token.token.punctuation.brace-level-2,.rainbow-braces .token.token.punctuation.brace-level-6{color:#f4adf4}.rainbow-braces .token.token.punctuation.brace-level-11,.rainbow-braces .token.token.punctuation.brace-level-3,.rainbow-braces .token.token.punctuation.brace-level-7{color:#6cb8e6}.rainbow-braces .token.token.punctuation.brace-level-12,.rainbow-braces .token.token.punctuation.brace-level-4,.rainbow-braces .token.token.punctuation.brace-level-8{color:#c699e3}pre.diff-highlight>code .token.token.deleted:not(.prefix),pre>code.diff-highlight .token.token.deleted:not(.prefix){background-color:rgba(205,102,96,.12157)}pre.diff-highlight>code .token.token.inserted:not(.prefix),pre>code.diff-highlight .token.token.inserted:not(.prefix){background-color:rgba(145,208,118,.12157)}.command-line .command-line-prompt{border-right:1px solid #0b121b}.command-line .command-line-prompt>span:before{color:rgba(141,161,185,.8549)}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}</style><link rel="preload" href="/guias/_nuxt/static/1645643589/4-2-herramienta-propia/state.js" as="script"><link rel="preload" href="/guias/_nuxt/static/1645643589/4-2-herramienta-propia/payload.js" as="script"><link rel="preload" href="/guias/_nuxt/static/1645643589/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><main><article><h1>Crear una herramienta propia para analytics</h1> <div class="nuxt-content"><h2 id="introducción"><a href="#introducci%C3%B3n" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Introducción</h2>
<p>En este tutorial van a crear la siguiente aplicación que muestra, en tiempo real, las fluctuaciones en precio de varias criptomonedas:</p>
<iframe width="850" height="750" src="https://precios-criptomonedas-funcional.1cgonza.repl.co/" frameborder="0" style="border:0"></iframe>
<blockquote>
<p><strong>Figura 1</strong><br>
<em>Cambio de precios en criptomonedas</em></p>
</blockquote>
<p>Vamos a hacerlo juntos, paso por paso, así que no se preocupen si nunca han creado una aplicación web. La idea con este tutorial es que se hagan a una idea general del proceso de visualización por medio de la programación. Vamos a hacer paralelos con lo que han aprendido de <em>Google Data Studio</em> para que puedan reconocer las similitudes y diferencias entre las herramientas prediseñadas y la creación de una herramienta propia. Con estas bases pueden explorar autónomamente nuevas fuentes de datos con diferentes APIs en futuros proyectos. Van a comenzar con una plantilla relativamente vacía y al final del tutorial van a tener la entrega de la semana prácticamente terminada, así que ánimo y si surgen preguntas en el camino no duden en contactarnos.</p>
<h3 id="espacio-de-trabajo"><a href="#espacio-de-trabajo" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Espacio de trabajo</h3>
<p>Para este ejercicio vamos a trabajar en Replit, una herramienta que nos permite crear aplicaciones en diferentes lenguajes de programación, directamente en el explorador sin tener que descargar o instalar nada.</p>
<ul>
<li>Paso 1: Crear cuenta en Replit
Primero van a <a href="https://replit.com/" target="_blank"></a><a href="https://replit.com/" rel="nofollow noopener noreferrer" target="_blank">https://replit.com/</a> y seleccionan la opción “Sign Up” en la esquina superior derecha. Se pueden registrar con su cuenta de Google, Github, Facebook o directamente diligenciando el formulario. Con esto ya tienen una cuenta gratuita que es suficiente para este ejercicio.</li>
<li>Paso 2: Hacer copia (Fork) de la plantilla
Luego de crear la cuenta, van al siguiente enlace: <a href="https://replit.com/@1cgonza/Criptomonedas-Precios?v=1" target="_blank"></a><a href="https://replit.com/@1cgonza/Criptomonedas-Precios?v=1" rel="nofollow noopener noreferrer" target="_blank">https://replit.com/@1cgonza/Criptomonedas-Precios?v=1</a> y hacen clic en el botón <strong>“Fork repl”</strong> que les debe aparecer a la derecha como se ve en la Figura 2 a continuación:</li>
</ul>
<img src="/guias/vysimgs/fork-repl.jpg" alt="Fork Repl">
<blockquote>
<p><strong>Figura 2</strong><br>
<em>Crear Fork de la plantilla en Replit</em></p>
</blockquote>
<p>El “Fork” crea una copia exacta de la plantilla, pero los cambios que hagan les pertenecen a ustedes. Todos los cambios que hagan en el código se guardan automáticamente y pueden volver a su cuenta en cualquier momento para seguir trabajando en la aplicación.</p>
<h3 id="interfaz-de-replit"><a href="#interfaz-de-replit" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Interfaz de Replit</h3>
<p>Luego de crear el "Fork", van a entrar a la interfaz de trabajo que está dividida en 3 partes:</p>
<ul>
<li>La lista de archivos a la izquierda.</li>
<li>El editor de código en el centro.</li>
<li>El visor de la aplicación a la derecha.</li>
</ul>
<img src="/guias/vysimgs/interfaz-replit.jpg" alt="interfaz Replit">
<blockquote>
<p><strong>Figura 3</strong><br>
<em>Interfaz Replit</em></p>
</blockquote>
<p>Ahora hagan clic en el botón verde “Run” para ver la plantilla en su estado inicial en el visor, se debe ver algo similar a esto:</p>
<img src="/guias/vysimgs/vista1.jpg" alt="interfaz Replit, vista">
<blockquote>
<p><strong>Figura 4</strong><br>
<em>Aplicación corriendo dentro de Replit</em></p>
</blockquote>
<p>Está bastante vacía, apenas tenemos unos cuantos campos de texto y pueden ver que algunos de esos textos cambian de manera dinámica. A pesar de la apariencia escueta que tiene la aplicación en este momento, ya están sucediendo bastantes cosas internamente: tenemos un esqueleto de las secciones que vamos a crear en el archivo “index.html”, también tenemos un archivo para definir estilos que se llama “style.css” y en el archivo “scripts.js” tenemos ya funcionando la conexión a la API con WebSockets y unas bases de modelado. Primero veamos cómo editar la estructura en HTML.</p>
<h3 id="html"><a href="#html" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>HTML</h3>
<p>El archivo de HTML en una aplicación web es la estructura del sitio y está dividido en dos secciones principales: <code>head</code> y <code>body</code>. En el <code>head</code> tenemos metadatos y cargamos archivos necesarios como el de “style.css”. Lo que hay en esta sección no se ve en la página, mientras que todo lo que está dentro de body sí se ve, así que nos vamos a enfocar en lo que se encuentra dentro de <code>body</code>.</p>
<p>Todo en HTML funciona por bloques, por ejemplo:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Título 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Titulo 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>párrafo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!—-</span> <span class="token attr-name">los</span> <span class="token attr-name">div</span> <span class="token attr-name">son</span> <span class="token attr-name">contenedores</span> <span class="token attr-name">genéricos</span> <span class="token attr-name">--</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre></div>
<p>El orden en el que ponen cada bloque es importante, ya que la página se construye de arriba hacia abajo. Como pueden ver, el "Título 1" está de primero y es lo primero que se ve en la página. Ahora, cambien el contenido de <code>&lt;h1>&lt;/h1></code> y denle clic al botón “Run” de nuevo para ver sus cambios en el visor. Escriban lo que quieran, luego van a usar este bloque para ponerle un título a su aplicación.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>titulo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>¡HOLA! Yo soy el título<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
</code></pre></div>
<p>En este archivo quiero que editen el Título y más abajo van a encontrar una sección llamada "Descripción". Allí van a reemplazar los textos que dicen "Párrafo 1 ...." y "Parrafo 2 ....." con el texto descriptivo que van a redactar cuando terminen de crear su aplicación. Esto lo pueden hacer al final, cuando entiendan mejor cómo funciona la visualización.</p>
<p>Si quieren ampliar sobre conceptos de HTML, les recomiendo los tutoriales de <a href="https://www.w3schools.com/html/" target="_blank">W3School HTML Tutorial</a>.</p>
<h3 id="css"><a href="#css" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>CSS</h3>
<p>Esta semana no vamos a hacer mucho énfasis en el diseño, pero el archivo de "styles.css" les permite modificar los estilos de todos los elementos que tienen en el HTML. La sintaxis es un poco diferente a la de HTML y pueden investigar todas las opciones de diseño en <a href="https://www.w3schools.com/css/default.asp" target="_blank">W3School CSS Tutorial</a>. Les dejé en la plantilla una estructura muy sencilla si quieren trabajar en el diseño, aunque no lo tienen que hacer para esta semana. A continuación les muestro cómo hacer unos cambios al estilo para que tengan una idea general:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-css"><code><span class="token selector"><span class="token id">#titulo</span></span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token color">cadetblue</span><span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token id">#descripcion</span></span> <span class="token punctuation">{</span>
  <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">px</span> solid <span class="token hexcode color">#000</span><span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token id">#descripcion</span> p</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token unit">px</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3 id="javascript"><a href="#javascript" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>JavaScript</h3>
<p>En el archivo "scripts.js" es donde vamos a crear nuestra aplicación. Desde este archivo podemos modificar la estructura y el contenido del HTML o los estilos del CSS de manera dinámica.</p>
<p>En el JavaScript vamos a hacer 3 cosas que vienen haciendo en <em>Google Data Studio</em>:</p>
<ol>
<li>Conectar la aplicación a una fuente de datos.</li>
<li>Modelar los datos.</li>
<li>Crear las visualizaciones.</li>
</ol>
<h4 id="conexión-con-datos-en-tiempo-real"><a href="#conexi%C3%B3n-con-datos-en-tiempo-real" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Conexión con datos en tiempo real</h4>
<p>En el tutorial anterior vimos cómo conectarse a la API de <em>CoinCap</em> por el protocolo de WebSockets con la siguiente estructura:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token comment">// Conectammos nuestra aplicación al API de coincap.</span>
<span class="token comment">// Vamos a solicitar actualizaciones de precios para: bitcoin, ethereum, monero y litecoin.</span>
<span class="token keyword">var</span> preciosEndPoint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'wss://ws.coincap.io/prices?assets=bitcoin,ethereum,monero,litecoin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Cuando una de las criptomonedas cambia de precio, ejecutamos la función procesarNuevoMensaje.</span>
preciosEndPoint<span class="token punctuation">.</span><span class="token property-access">onmessage</span> <span class="token operator">=</span> procesarNuevoMensaje<span class="token punctuation">;</span>

<span class="token comment">// Función que recibe los mensajes del Socket</span>
<span class="token keyword">function</span> <span class="token function">procesarNuevoMensaje</span><span class="token punctuation">(</span><span class="token parameter">mensaje</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Convertimos los datos de texto a formato JSON</span>
  <span class="token keyword">var</span> mensajeJson <span class="token operator">=</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">parse</span><span class="token punctuation">(</span>mensaje<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Más adelante en el tutorial voy a explicar el resto de lo que ven dentro de esta función.</span>
  <span class="token comment">// ....</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h4 id="estructura-para-modelado-de-datos"><a href="#estructura-para-modelado-de-datos" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Estructura para modelado de datos</h4>
<p>La semana pasada vimos cómo limpiar y modelar los datos por medio de scripts en <em>Google Data Studio</em>. Este proceso nos ayudó a convertir la estructura original de los datos a una nueva estructura que tiene sentido para nuestra investigación. En el caso de <em>CoinCap</em>, estamos conectados a la API para que nos envíe datos en el momento que cambia el precio de alguna criptomoneda que nos interesa. La estructura original que nos llega es simplemente el nombre de la moneda y su valor actual que se ve así en formato JSON:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-json"><code><span class="token punctuation">{</span>
  <span class="token property">"bitcoin"</span><span class="token operator">:</span> <span class="token string">"6389.06534240"</span><span class="token punctuation">,</span>
  <span class="token property">"ethereum"</span><span class="token operator">:</span> <span class="token string">"192.93111286"</span><span class="token punctuation">,</span>
  <span class="token property">"monero"</span><span class="token operator">:</span> <span class="token string">"108.90302506"</span><span class="token punctuation">,</span>
  <span class="token property">"litecoin"</span><span class="token operator">:</span> <span class="token string">"52.25484165"</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Para enriquecer estos datos y producir un valor agregado, podemos crear una nueva estructura con información que vamos calculando a medida que corre la aplicación. En la plantilla van a encontrar esa estructura armada de la siguiente manera:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token keyword">const</span> monedas <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> nombre<span class="token operator">:</span> <span class="token string">'bitcoin'</span><span class="token punctuation">,</span> precioActual<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasAlto<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasBajo<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> datos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> nombre<span class="token operator">:</span> <span class="token string">'ethereum'</span><span class="token punctuation">,</span> precioActual<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasAlto<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasBajo<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> datos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> nombre<span class="token operator">:</span> <span class="token string">'monero'</span><span class="token punctuation">,</span> precioActual<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasAlto<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasBajo<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> datos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> nombre<span class="token operator">:</span> <span class="token string">'litecoin'</span><span class="token punctuation">,</span> precioActual<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasAlto<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasBajo<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> datos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div>
<p>En esta lista (o array), creamos un objeto por cada una de las criptomonedas que le estamos solicitando a la API. Inicialmente no tienen ningún valor y vamos a ir actualizando esta estructura a medida que recibimos datos.</p>
<h4 id="procesamiento-y-modelado-de-los-datos"><a href="#procesamiento-y-modelado-de-los-datos" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Procesamiento y modelado de los datos</h4>
<p>Volvamos ahora a la función donde recibimos mensajes nuevos de la API para introducirlos a la estructura que definimos en el modelo <code>const monedas = [...]</code> anteriormente:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token comment">// Función que recibe los mensajes del Socket</span>
<span class="token keyword">function</span> <span class="token function">procesarNuevoMensaje</span><span class="token punctuation">(</span><span class="token parameter">mensaje</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Convertimos los datos de texto a formato JSON</span>
  <span class="token keyword">var</span> mensajeJson <span class="token operator">=</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">parse</span><span class="token punctuation">(</span>mensaje<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Iteramos sobre los valores del mensaje que vienen en parejas de "nombre": "precio"</span>
  <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> nombreMoneda <span class="token keyword">in</span> mensajeJson<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// En el siguiente loop, pasamos por cada objeto que definimos en la variable "monedas" que contiene la nueva estructura de datos que queremos llenar.</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> monedas<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// objetoMoneda va a ser cada uno de los objetos del modelado, por ejemplo:</span>
      <span class="token comment">// cuando i = 0, objetoMoneda es: {nombre: "bitcoin", precioActual: null, precioMasAlto: null, precioMasBajo: null, datos: []}</span>
      <span class="token keyword">var</span> objetoMoneda <span class="token operator">=</span> monedas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token comment">// Comparamos el nombre de la moneda en nuestro modelo con el nombre de la moneda que cambió de valor y fue enviado por la API en el mensaje actual.</span>
      <span class="token comment">// Si coinciden, significa que podemos actualizar los datos de nuestro modelo para esa moneda</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">nombre</span> <span class="token operator">===</span> nombreMoneda<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Extraemos el precio actual que llegó en el mensaje y lo guardamos en una variable para usarla varias veces de ahora en adelante.</span>
        <span class="token keyword">var</span> nuevoPrecio <span class="token operator">=</span> mensajeJson<span class="token punctuation">[</span>nombreMoneda<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// En JavaScript, podemos insertar un nuevo elemento a un array usando push()</span>
        <span class="token comment">// Aquí estamos sumando una nueva entrada a los datos de la moneda que acaba de cambiar el precio.</span>
        <span class="token comment">// En nuestra estructura de modelado: {nombre: "bitcoin", precioActual: null, precioMasAlto: null, precioMasBajo: null, datos: []}</span>
        <span class="token comment">// va a quedar guardada en el array "datos"</span>
        objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          fecha<span class="token operator">:</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Este va a ser nuestro eje X, usamos la fecha del presente ya que la aplicación funciona en tiempo real.</span>
          precio<span class="token operator">:</span> nuevoPrecio<span class="token punctuation">,</span> <span class="token comment">// El eje Y en la visualización va a ser el precio.</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Volviendo a la estructura: {nombre: "bitcoin", precioActual: null, precioMasAlto: null, precioMasBajo: null, datos: []}</span>
        <span class="token comment">// podemos cambiar directamente el precioActual de la moneda con el precio que acaba de llegar de la API.</span>
        objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span> <span class="token operator">=</span> nuevoPrecio<span class="token punctuation">;</span>

        <span class="token comment">// Ahora hagamos algo más interesante, vamos a guardar el precio más alto al que ha llegado la moneda.</span>
        <span class="token comment">// La siguiente comparación revisa si el valor NO es "null" con: !objetoMoneda.precioMasAlto,</span>
        <span class="token comment">// O si el precio que acaba de llegar es mayor al precioMasAlto guardado en nuestro modelo.</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasAlto</span> <span class="token operator">||</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasAlto</span> <span class="token operator">&lt;</span> nuevoPrecio<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// Si alguna de estas dos pruebas es verdadera, cambiamos el precioMasAlto en el modelo.</span>
          objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasAlto</span> <span class="token operator">=</span> nuevoPrecio<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Hacemos lo mismo para el precioMasBajo haciendo la comparación invertida.</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasBajo</span> <span class="token operator">||</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasBajo</span> <span class="token operator">></span> nuevoPrecio<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasBajo</span> <span class="token operator">=</span> nuevoPrecio<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Para terminar, actualizamos la gráfica que tengamos seleccionada en el menú</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>nombreMoneda <span class="token operator">===</span> menu<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">actualizar</span><span class="token punctuation">(</span>monedas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Independiente del lenguaje de programación que les guste utilizar, procesar los datos como lo acabamos de hacer es exigente pero fundamental a la hora de extraer valor de una base de datos. Es muy raro que los datos los encuentren perfectamente estructurados para el valor que ustedes les pueden asignar y las historias que pueden contarle a otros sobre ellos. Dominar el preprocesamiento y modelado de datos toma tiempo pues requiere de mucha abstracción, debemos pensar de manera anticipada en las potencias que tienen los datos y abrir esas potencias reestructurándolos. Si sienten que la aplicación puede decir cosas nuevas pero los datos aún no les sirven para decirlo, este es el primer lugar que pueden revisar creando otro modelo de los datos o sumando variables al existente. Por ejemplo: ¿cómo guardar las fechas de los puntos más altos o bajos en el precio de cada criptomoneda?, o más retador aún ¿en qué momentos del día hay mayor fluctuación en los precios?. No tienen que implementar esto en el modelo, pero pueden buscar soluciones a estas preguntas si quieren mejorar sus habilidades en programación.</p>
<h4 id="textos-dinámicos"><a href="#textos-din%C3%A1micos" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Textos dinámicos</h4>
<p>Ahora vamos a utilizar nuestros datos procesados para darle vida a la aplicación, es hora de visualizar los datos en una gráfica y al tiempo actualizar los textos de contexto que la acompañan. En la plantilla van a encontrar una función que se llama "actualizar" que llamamos al final de "procesarNuevosDatos":</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token comment">// En JavaScript podemos extraer elementos del HTML para actualizar su contenido dinámicamente.</span>
<span class="token comment">// Si van al archivo index.html van a ver que hay 2 elementos vacíos con los siguientes ids: &lt;p id="contexto1">&lt;/p>  &lt;p id="contexto2">&lt;/p></span>
<span class="token comment">// Los vamos a guardar en variables para luego insertar el contenido a medida que los datos se actualizan.</span>
<span class="token keyword">var</span> contexto1 <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'contexto1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> contexto2 <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'contexto2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Este objeto es una ayuda nativa de JavaScript para convertir números a un formato de moneda.</span>
<span class="token comment">// Pueden leer más en: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat</span>
<span class="token keyword">var</span> formatoUSD <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">'en-US'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> style<span class="token operator">:</span> <span class="token string">'currency'</span><span class="token punctuation">,</span> currency<span class="token operator">:</span> <span class="token string">'USD'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Esta función la ejecutamos cuando hay datos nuevos o al cambiar la criptomoneda en el menú.</span>
<span class="token comment">// Recibe el objeto completo de una criptomoneda como lo definimos en el modelo.</span>
<span class="token comment">// Por ejemplo: { nombre: 'bitcoin', precioActual: null, precioMasAlto: null, precioMasBajo: null, datos: [] },</span>
<span class="token keyword">function</span> <span class="token function">actualizar</span><span class="token punctuation">(</span><span class="token parameter">objetoMoneda</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Este texto es una combinación entre textos estáticos y variables.</span>
  <span class="token comment">// De momento no es muy descriptivo, deben modificarlo para comenzar a ser más claros con el público general.</span>
  <span class="token comment">// El que ven en el ejemplo terminado es:</span>
  <span class="token comment">// contexto1.innerText = "Actualmente, el precio de " + menu.value + " es de: " + formatoUSD.format(objetoMoneda.precioActual) + " USD.";</span>
  contexto1<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'- '</span> <span class="token operator">+</span> menu<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> formatoUSD<span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' USD.'</span><span class="token punctuation">;</span>

  <span class="token comment">// Para el segundo texto vamos a hacer comparaciones entre el precio inicial y el actual.</span>
  <span class="token comment">// El texto va a indicar si es igual, ha subido o bajado y la diferencia de cuánto ha cambiado el precio.</span>
  <span class="token keyword">var</span> precioInicial <span class="token operator">=</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">precio</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>precioInicial <span class="token operator">&lt;</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> diferencia <span class="token operator">=</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span> <span class="token operator">-</span> precioInicial<span class="token punctuation">;</span>
    contexto2<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'subió + '</span> <span class="token operator">+</span> formatoUSD<span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span>diferencia<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>precioInicial <span class="token operator">></span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> diferencia <span class="token operator">=</span> precioInicial <span class="token operator">-</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span><span class="token punctuation">;</span>
    contexto2<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'bajó - '</span> <span class="token operator">+</span> formatoUSD<span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span>diferencia<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
    contexto2<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'igual = 0'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Ustedes deben cambiar estos textos para la entrega, recuerden que su público objetivo es el general, los textos que tiene la plantilla no son claros y pueden ser más descriptivos.</p>
<h4 id="visualización"><a href="#visualizaci%C3%B3n" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Visualización</h4>
<p>Para visualizar los datos vamos a usar la librería D3 que es bastante robusta y permite crear todo tipo de gráficas, tanto las que vemos disponibles en <em>Google Data Studio</em> como otras que no van a encontrar allí. Para este caso vamos a usar una línea para mostrar la fluctuación de precios en las criptomonedas, aparte de ser sencilla de implementar nos funciona narrativamente.</p>
<p>Justo antes de la declaración de la función creamos el contenedor de la gráfica:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token keyword">function</span> <span class="token function">actualizar</span><span class="token punctuation">(</span><span class="token parameter">objetoMoneda</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token punctuation">}</span>
</code></pre></div>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token comment">// Pueden cambiar los valores de estas variables para cambiar el tamaño del contenedor.</span>
<span class="token comment">// Usamos márgenes para darle espacio a los textos de cada eje.</span>
<span class="token keyword">var</span> margen <span class="token operator">=</span> <span class="token punctuation">{</span> top<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> right<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span> bottom<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span> left<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ancho <span class="token operator">=</span> <span class="token number">800</span> <span class="token operator">-</span> margen<span class="token punctuation">.</span><span class="token property-access">left</span> <span class="token operator">-</span> margen<span class="token punctuation">.</span><span class="token property-access">right</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> alto <span class="token operator">=</span> <span class="token number">400</span> <span class="token operator">-</span> margen<span class="token punctuation">.</span><span class="token property-access">top</span> <span class="token operator">-</span> margen<span class="token punctuation">.</span><span class="token property-access">bottom</span><span class="token punctuation">;</span>

<span class="token comment">// En D3 seleccionamos el elemento de HTML donde vamos a insertar la gráfica, en index.html es: &lt;div id="modulo2">&lt;/div></span>
<span class="token keyword">const</span> svg <span class="token operator">=</span> d3
  <span class="token punctuation">.</span><span class="token method function property-access">select</span><span class="token punctuation">(</span><span class="token string">'#modulo2'</span><span class="token punctuation">)</span> <span class="token comment">// elemento existente en el HTML para insertar gráfica</span>
  <span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> ancho <span class="token operator">+</span> margen<span class="token punctuation">.</span><span class="token property-access">left</span> <span class="token operator">+</span> margen<span class="token punctuation">.</span><span class="token property-access">right</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">,</span> alto <span class="token operator">+</span> margen<span class="token punctuation">.</span><span class="token property-access">top</span> <span class="token operator">+</span> margen<span class="token punctuation">.</span><span class="token property-access">bottom</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'transform'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>margen<span class="token punctuation">.</span><span class="token property-access">left</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>margen<span class="token punctuation">.</span><span class="token property-access">top</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Definición general de cada eje:</span>

<span class="token comment">// El eje x es el tiempo que en nuestros datos guardamos en cada instancia usando Date.now(), que representa la fecha</span>
<span class="token comment">// D3 puede procesar fechas usando la escala "scaleTime()"</span>
<span class="token comment">// El rango va de 0 al ancho de la gráfica.</span>
<span class="token keyword">const</span> x <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token method function property-access">scaleTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> ancho<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ejeX <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token method function property-access">axisBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">scale</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
svg<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'transform'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(0, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>alto<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'ejeX'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// El eje Y representa la variación de precios.</span>
<span class="token comment">// Usamos la escala lineal en D3:</span>
<span class="token keyword">const</span> y <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token method function property-access">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span>alto<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ejeY <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token method function property-access">axisLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">scale</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
svg<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'ejeY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Lo que acabamos de hacer es igual a agregar un "Time series chart" en <em>Google Data Studio</em> a un reporte. En <em>Google Data Studio</em> lo hacemos con un par de clicks y acá son varias líneas de código, pero no se desanimen, luego vale la pena.</p>
<h4 id="actualizar-visualización"><a href="#actualizar-visualizaci%C3%B3n" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Actualizar visualización</h4>
<p>Por último, volvemos a la función <code>actualizar</code> y agregamos el siguiente código para actualizar la gráfica en tiempo real:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token comment">// El eje X que definimos antes lo actualizamos con un método de d3 que busca el rango de fechas en todos los datos disponibles hasta el momento.</span>
<span class="token comment">// Van a ver que al principio este rango es muy pequeño y se va incrementando a medida que hay más datos.</span>
<span class="token comment">// Los dominios en d3 se definen con un array con dos valores, el primero es el mínimo y el segundo el máximo:</span>
<span class="token comment">// x.domain([min, max])</span>
x<span class="token punctuation">.</span><span class="token method function property-access">domain</span><span class="token punctuation">(</span>
  d3<span class="token punctuation">.</span><span class="token method function property-access">extent</span><span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> d<span class="token punctuation">.</span><span class="token property-access">fecha</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Hace una transición animada al actualizar el ejeX, la duración es de 300 milisegundos</span>
svg<span class="token punctuation">.</span><span class="token method function property-access">selectAll</span><span class="token punctuation">(</span><span class="token string">'.ejeX'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">duration</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>ejeX<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Otra forma de definir el rango del dominio es buscar el menor y mayor valor en los datos.</span>
<span class="token comment">// El método d3.extent hace exactamente lo mismo, pero dejo este diferente como ejemplo.</span>
<span class="token comment">// Intenten cambiar esto por: y.domain([0, d3.max(objetoMoneda.datos, function (d) { return d.precio; })]);</span>
<span class="token comment">// y verán que es difícil ver los cambios. Acá estamos cortando la base para que no comience en 0 sino en el menor precio.</span>

y<span class="token punctuation">.</span><span class="token method function property-access">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  d3<span class="token punctuation">.</span><span class="token method function property-access">min</span><span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> d<span class="token punctuation">.</span><span class="token property-access">precio</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  d3<span class="token punctuation">.</span><span class="token method function property-access">max</span><span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> d<span class="token punctuation">.</span><span class="token property-access">precio</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
svg<span class="token punctuation">.</span><span class="token method function property-access">selectAll</span><span class="token punctuation">(</span><span class="token string">'.ejeY'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">duration</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>ejeY<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Pasamos los datos actuales a la línea que vamos a pintar</span>
<span class="token keyword">const</span> linea <span class="token operator">=</span> svg<span class="token punctuation">.</span><span class="token method function property-access">selectAll</span><span class="token punctuation">(</span><span class="token string">'.linea'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span><span class="token punctuation">[</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Finalmente pintamos la línea</span>
linea
  <span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'linea'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">duration</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span>
    <span class="token string">'d'</span><span class="token punctuation">,</span>
    d3
      <span class="token punctuation">.</span><span class="token method function property-access">line</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token method function property-access">x</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> <span class="token function">x</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token property-access">fecha</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// El eje X son las fechas</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token method function property-access">y</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> <span class="token function">y</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token property-access">precio</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// El eje Y son los precios</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'fill'</span><span class="token punctuation">,</span> <span class="token string">'none'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'stroke'</span><span class="token punctuation">,</span> <span class="token string">'#42b3f5'</span><span class="token punctuation">)</span> <span class="token comment">// Pueden cambiar el color de la línea</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'stroke-width'</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Grosor de la línea</span>
</code></pre></div>
<p>Llegamos al final, ¡felicitaciones!, si todo lo copiaron bien pueden hacer clic en "Run" y verán la visualización en vivo. A continuación dejo el código completo por si quieren comparar:</p>
<h4 id="código-final"><a href="#c%C3%B3digo-final" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Código final</h4>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token doc-comment comment">/**
 * Fuente de datos y modelado
 */</span>

<span class="token comment">// Conectamos nuestra aplicación al API de coincap.</span>
<span class="token comment">// Vamos a solicitar actualizaciones de precios para: bitcoin, ethereum, monero y litecoin.</span>
<span class="token keyword">var</span> preciosEndPoint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'wss://ws.coincap.io/prices?assets=bitcoin,ethereum,monero,litecoin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Cuando una de las criptomonedas cambia de precio, ejecutamos la función procesarNuevoMensaje.</span>
preciosEndPoint<span class="token punctuation">.</span><span class="token property-access">onmessage</span> <span class="token operator">=</span> procesarNuevoMensaje<span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Preprocesamiento y Modelado:
 * El API nos envía sólo 1 tipo de dato que es el precio actual de las criptomonedas.
 * A pesar de esto, podemos hacer cálculos matemáticos para producir una estructura de datos que nos permita darle sentido al cambio de precios que vamos a mostrar en la visualización.
 */</span>
<span class="token keyword">const</span> monedas <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> nombre<span class="token operator">:</span> <span class="token string">'bitcoin'</span><span class="token punctuation">,</span> precioActual<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasAlto<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasBajo<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> datos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> nombre<span class="token operator">:</span> <span class="token string">'ethereum'</span><span class="token punctuation">,</span> precioActual<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasAlto<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasBajo<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> datos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> nombre<span class="token operator">:</span> <span class="token string">'monero'</span><span class="token punctuation">,</span> precioActual<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasAlto<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasBajo<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> datos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> nombre<span class="token operator">:</span> <span class="token string">'litecoin'</span><span class="token punctuation">,</span> precioActual<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasAlto<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> precioMasBajo<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> datos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Función que recibe los mensajes del Socket</span>
<span class="token keyword">function</span> <span class="token function">procesarNuevoMensaje</span><span class="token punctuation">(</span><span class="token parameter">mensaje</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Convertimos los datos de texto a formato JSON</span>
  <span class="token keyword">var</span> mensajeJson <span class="token operator">=</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">parse</span><span class="token punctuation">(</span>mensaje<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Iteramos sobre los valores del mensaje que vienen en parejas de "nombre": "precio"</span>
  <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> nombreMoneda <span class="token keyword">in</span> mensajeJson<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// En el siguiente loop, pasamos por cada objeto que definimos en la variable "monedas" que contiene la nueva estructura de datos que queremos llenar.</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> monedas<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// objetoMoneda va a ser cada uno de los objetos del modelado, por ejemplo:</span>
      <span class="token comment">// cuando i = 0, objetoMoneda es: {nombre: "bitcoin", precioActual: null, precioMasAlto: null, precioMasBajo: null, datos: []}</span>
      <span class="token keyword">var</span> objetoMoneda <span class="token operator">=</span> monedas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token comment">// Comparamos el nombre de la moneda en nuestro modelo con el nombre de la moneda que cambió de valor y fue enviado por la API en el mensaje actual.</span>
      <span class="token comment">// Si coinciden, significa que podemos actualizar los datos de nuestro modelo para esa moneda</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">nombre</span> <span class="token operator">===</span> nombreMoneda<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Extraemos el precio actual que llegó en el mensaje y lo guardamos en una variable para usarla varias veces de ahora en adelante.</span>
        <span class="token keyword">var</span> nuevoPrecio <span class="token operator">=</span> mensajeJson<span class="token punctuation">[</span>nombreMoneda<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// En JavaScript, podemos insertar un nuevo elemento a un array usando push()</span>
        <span class="token comment">// Aquí estamos sumando una nueva entrada a los datos de la moneda que acaba de cambiar el precio.</span>
        <span class="token comment">// En nuestra estructura de modelado: {nombre: "bitcoin", precioActual: null, precioMasAlto: null, precioMasBajo: null, datos: []}</span>
        <span class="token comment">// va a quedar guardada en el array "datos"</span>
        objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          fecha<span class="token operator">:</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Este va a ser nuestro eje X, usamos la fecha del presente ya que la aplicación funciona en tiempo real.</span>
          precio<span class="token operator">:</span> nuevoPrecio<span class="token punctuation">,</span> <span class="token comment">// El eje Y en la visualización va a ser el precio.</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Volviendo a la estructura: {nombre: "bitcoin", precioActual: null, precioMasAlto: null, precioMasBajo: null, datos: []}</span>
        <span class="token comment">// podemos cambiar directamente el precioActual de la moneda con el precio que acaba de llegar de la API.</span>
        objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span> <span class="token operator">=</span> nuevoPrecio<span class="token punctuation">;</span>

        <span class="token comment">// Ahora hagamos algo más interesante, vamos a guardar el precio más alto al que ha llegado la moneda.</span>
        <span class="token comment">// La siguiente comparación revisa si el valor NO es "null" con: !objetoMoneda.precioMasAlto,</span>
        <span class="token comment">// O si el precio que acaba de llegar es mayor al precioMasAlto guardado en nuestro modelo.</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasAlto</span> <span class="token operator">||</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasAlto</span> <span class="token operator">&lt;</span> nuevoPrecio<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// Si alguna de estas dos pruebas es verdadera, cambiamos el precioMasAlto en el modelo.</span>
          objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasAlto</span> <span class="token operator">=</span> nuevoPrecio<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Hacemos lo mismo para el precioMasBajo haciendo la comparación invertida.</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasBajo</span> <span class="token operator">||</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasBajo</span> <span class="token operator">></span> nuevoPrecio<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioMasBajo</span> <span class="token operator">=</span> nuevoPrecio<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Para terminar, actualizamos la gráfica que tengamos seleccionada en el menú</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>nombreMoneda <span class="token operator">===</span> menu<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">actualizar</span><span class="token punctuation">(</span>monedas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token doc-comment comment">/** FIN de Preprocesamiento y modelado. */</span>

<span class="token doc-comment comment">/**
 * Visualización y textos dinámicos
 */</span>

<span class="token comment">// En JavaScript podemos extraer elementos del HTML para actualizar su contenido dinámicamente.</span>
<span class="token comment">// Si van al archivo index.html van a ver que hay 2 elementos vacíos con los siguientes ids: &lt;p id="contexto1">&lt;/p>  &lt;p id="contexto2">&lt;/p></span>
<span class="token comment">// Los vamos a guardar en variables para luego insertar el contenido a medida que los datos se actualizan.</span>
<span class="token keyword">var</span> contexto1 <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'contexto1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> contexto2 <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'contexto2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Este objeto es una ayuda nativa de JavaScript para convertir números a un formato de moneda.</span>
<span class="token comment">// Pueden leer más en: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat</span>
<span class="token keyword">var</span> formatoUSD <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">'en-US'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> style<span class="token operator">:</span> <span class="token string">'currency'</span><span class="token punctuation">,</span> currency<span class="token operator">:</span> <span class="token string">'USD'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Gráfica
 */</span>
<span class="token comment">// Pueden cambiar los valores de estas variables para cambiar el tamaño del contenedor.</span>
<span class="token comment">// Usamos margenes para darle espacio a los textos de cada eje.</span>
<span class="token keyword">var</span> margen <span class="token operator">=</span> <span class="token punctuation">{</span> top<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> right<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span> bottom<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span> left<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ancho <span class="token operator">=</span> <span class="token number">800</span> <span class="token operator">-</span> margen<span class="token punctuation">.</span><span class="token property-access">left</span> <span class="token operator">-</span> margen<span class="token punctuation">.</span><span class="token property-access">right</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> alto <span class="token operator">=</span> <span class="token number">400</span> <span class="token operator">-</span> margen<span class="token punctuation">.</span><span class="token property-access">top</span> <span class="token operator">-</span> margen<span class="token punctuation">.</span><span class="token property-access">bottom</span><span class="token punctuation">;</span>

<span class="token comment">// En D3 seleccionamos el elemento de HTML donde vamos a insertar la gráfica, en index.html es: &lt;div id="modulo2">&lt;/div></span>
<span class="token keyword">const</span> svg <span class="token operator">=</span> d3
  <span class="token punctuation">.</span><span class="token method function property-access">select</span><span class="token punctuation">(</span><span class="token string">'#modulo2'</span><span class="token punctuation">)</span> <span class="token comment">// elemento existente en el HTML para insertar gráfica</span>
  <span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> ancho <span class="token operator">+</span> margen<span class="token punctuation">.</span><span class="token property-access">left</span> <span class="token operator">+</span> margen<span class="token punctuation">.</span><span class="token property-access">right</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">,</span> alto <span class="token operator">+</span> margen<span class="token punctuation">.</span><span class="token property-access">top</span> <span class="token operator">+</span> margen<span class="token punctuation">.</span><span class="token property-access">bottom</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'transform'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>margen<span class="token punctuation">.</span><span class="token property-access">left</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>margen<span class="token punctuation">.</span><span class="token property-access">top</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Definición general de cada eje:</span>

<span class="token comment">// El eje x es el tiempo que en nuestros datos guardamos en cada instancia usando Date.now(), que representa la fecha</span>
<span class="token comment">// D3 puede procesar fechas usando la escala "scaleTime()"</span>
<span class="token comment">// El rango va de 0 al ancho de la gráfica.</span>
<span class="token keyword">const</span> x <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token method function property-access">scaleTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> ancho<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ejeX <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token method function property-access">axisBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">scale</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
svg<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'transform'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(0, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>alto<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'ejeX'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// El eje Y representa la variación de precios.</span>
<span class="token comment">// Usamos la escala lineal en D3:</span>
<span class="token keyword">const</span> y <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token method function property-access">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span>alto<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ejeY <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token method function property-access">axisLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">scale</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
svg<span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'ejeY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Esta función la ejecutamos cuando hay datos nuevos o al cambiar la criptomoneda en el menú.</span>
<span class="token comment">// Recibe el objeto completo de una criptomoneda como lo definimos en el modelo.</span>
<span class="token comment">// Por ejemplo: { nombre: 'bitcoin', precioActual: null, precioMasAlto: null, precioMasBajo: null, datos: [] },</span>
<span class="token keyword">function</span> <span class="token function">actualizar</span><span class="token punctuation">(</span><span class="token parameter">objetoMoneda</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Este texto es una combinación entre textos estáticos y variables.</span>
  <span class="token comment">// De momento no es muy descriptivo, deben modificarlo para comenzar a ser más claros con el público general.</span>
  <span class="token comment">// El que ven en el ejemplo terminado es:</span>
  <span class="token comment">// contexto1.innerText = "Actualmente, el precio de " + menu.value + " es de: " + formatoUSD.format(objetoMoneda.precioActual) + " USD.";</span>
  contexto1<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'- '</span> <span class="token operator">+</span> menu<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> formatoUSD<span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' USD.'</span><span class="token punctuation">;</span>

  <span class="token comment">// Para el segundo texto vamos a hacer comparaciones entre el precio inicial y el actual.</span>
  <span class="token comment">// El texto va a indicar si es igual, ha subido o bajado y la diferencia de cuánto ha cambiado el precio.</span>
  <span class="token keyword">var</span> precioInicial <span class="token operator">=</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">precio</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>precioInicial <span class="token operator">&lt;</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> diferencia <span class="token operator">=</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span> <span class="token operator">-</span> precioInicial<span class="token punctuation">;</span>
    contexto2<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'subió + '</span> <span class="token operator">+</span> formatoUSD<span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span>diferencia<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>precioInicial <span class="token operator">></span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> diferencia <span class="token operator">=</span> precioInicial <span class="token operator">-</span> objetoMoneda<span class="token punctuation">.</span><span class="token property-access">precioActual</span><span class="token punctuation">;</span>
    contexto2<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'bajó - '</span> <span class="token operator">+</span> formatoUSD<span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span>diferencia<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
    contexto2<span class="token punctuation">.</span><span class="token property-access">innerText</span> <span class="token operator">=</span> <span class="token string">'igual = 0'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// El eje X que definimos antes lo actualizamos con un método de d3 que busca el rango de fechas en todos los datos disponibles hasta el momento.</span>
  <span class="token comment">// Van a ver que al principio este rango es muy pequeño y se va incrementando a medida que hay más datos.</span>
  <span class="token comment">// Los dominios en d3 se definen con un array con dos valores, el primero es el mínimo y el segundo el máximo:</span>
  <span class="token comment">// x.domain([min, max])</span>
  x<span class="token punctuation">.</span><span class="token method function property-access">domain</span><span class="token punctuation">(</span>
    d3<span class="token punctuation">.</span><span class="token method function property-access">extent</span><span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> d<span class="token punctuation">.</span><span class="token property-access">fecha</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Hace una transición animada al actualizar el ejeX, la duración es de 300 milisegundos</span>
  svg<span class="token punctuation">.</span><span class="token method function property-access">selectAll</span><span class="token punctuation">(</span><span class="token string">'.ejeX'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">duration</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>ejeX<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Otra forma de definir el rango del dominio es buscar el menor y mayor valor en los datos.</span>
  <span class="token comment">// El método d3.extent hace exactamente lo mismo, pero dejo este diferente como ejemplo.</span>
  <span class="token comment">// Intenten cambiar esto por: y.domain([0, d3.max(objetoMoneda.datos, function (d) { return d.precio; })]);</span>
  <span class="token comment">// y verán que es difícil ver los cambios. Acá estamos cortando la base para que no comience en 0 sino en el menor precio.</span>

  y<span class="token punctuation">.</span><span class="token method function property-access">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    d3<span class="token punctuation">.</span><span class="token method function property-access">min</span><span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> d<span class="token punctuation">.</span><span class="token property-access">precio</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    d3<span class="token punctuation">.</span><span class="token method function property-access">max</span><span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> d<span class="token punctuation">.</span><span class="token property-access">precio</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  svg<span class="token punctuation">.</span><span class="token method function property-access">selectAll</span><span class="token punctuation">(</span><span class="token string">'.ejeY'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">duration</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>ejeY<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Pasamos los datos actuales a la línea que vamos a pintar</span>
  <span class="token keyword">const</span> linea <span class="token operator">=</span> svg<span class="token punctuation">.</span><span class="token method function property-access">selectAll</span><span class="token punctuation">(</span><span class="token string">'.linea'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span><span class="token punctuation">[</span>objetoMoneda<span class="token punctuation">.</span><span class="token property-access">datos</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> d<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Finalmente pintamos la línea</span>
  linea
    <span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'linea'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">duration</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span>
      <span class="token string">'d'</span><span class="token punctuation">,</span>
      d3
        <span class="token punctuation">.</span><span class="token method function property-access">line</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">x</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">return</span> <span class="token function">x</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token property-access">fecha</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// El eje X son las fechas</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">y</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">return</span> <span class="token function">y</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token property-access">precio</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// El eje Y son los precios</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'fill'</span><span class="token punctuation">,</span> <span class="token string">'none'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'stroke'</span><span class="token punctuation">,</span> <span class="token string">'#42b3f5'</span><span class="token punctuation">)</span> <span class="token comment">// Pueden cambiar el color de la línea</span>
    <span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'stroke-width'</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Grosor de la línea</span>
<span class="token punctuation">}</span>

<span class="token comment">// FIN de Visualización y textos dinámicos</span>

<span class="token doc-comment comment">/**
 * MENÚ
 */</span>
<span class="token keyword">var</span> menu <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'menuMonedas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

menu<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">onchange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> objetoMoneda <span class="token operator">=</span> monedas<span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> obj<span class="token punctuation">.</span><span class="token property-access">nombre</span> <span class="token operator">===</span> menu<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">actualizar</span><span class="token punctuation">(</span>objetoMoneda<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// ----- FIN MENÚ ----</span>
</code></pre></div></div></article></main></div></div><script defer src="/guias/_nuxt/static/1645643589/4-2-herramienta-propia/state.js"></script><script src="/guias/_nuxt/53c0541.js" defer></script><script src="/guias/_nuxt/f10912f.js" defer></script><script src="/guias/_nuxt/ec44050.js" defer></script><script src="/guias/_nuxt/6b4b35f.js" defer></script><script src="/guias/_nuxt/f0dad64.js" defer></script>
  </body>
</html>
